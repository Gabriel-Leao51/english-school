import './polyfills.server.mjs';
import{a as lt,b as M}from"./chunk-F56TD3FF.mjs";import{a as at}from"./chunk-IMMMZWSA.mjs";import{a as k,b as S,c as A,d as X,e as Z,f as tt,g as et,h as ot,i as it,j as rt,k as nt,l as B,m as T}from"./chunk-2Z63PRNR.mjs";import"./chunk-PN6GMUDE.mjs";import{o as K}from"./chunk-QZK6HHLT.mjs";import{$a as l,Ab as $,Cb as Y,Ga as L,H as D,Ja as a,Ka as v,Sa as R,W as x,Za as d,bb as w,db as n,ea as _,eb as r,fa as f,fb as g,ib as b,kb as u,kc as H,la as y,lb as m,lc as E,ob as j,oc as J,pb as U,qb as z,rb as W,sb as c,tb as P,ub as I,wb as C,yb as G,z as N,zb as Q}from"./chunk-OBIY6IM3.mjs";import"./chunk-VVCT4QZE.mjs";function pt(e,s){e&1&&(n(0,"div"),c(1," T\xEDtulo \xE9 obrigat\xF3rio "),r())}function ut(e,s){if(e&1&&(n(0,"div",21),d(1,pt,2,0,"div",22),r()),e&2){let t,o=m();a(),l("ngIf",(t=o.postForm.get("title"))==null?null:t.hasError("required"))}}function gt(e,s){e&1&&(n(0,"div"),c(1," Conte\xFAdo \xE9 obrigat\xF3rio "),r())}function _t(e,s){if(e&1&&(n(0,"div",21),d(1,gt,2,0,"div",22),r()),e&2){let t,o=m();a(),l("ngIf",(t=o.postForm.get("content"))==null?null:t.hasError("required"))}}function ft(e,s){e&1&&(n(0,"div"),c(1," Autor \xE9 obrigat\xF3rio "),r())}function vt(e,s){if(e&1&&(n(0,"div",21),d(1,ft,2,0,"div",22),r()),e&2){let t,o=m();a(),l("ngIf",(t=o.postForm.get("author"))==null?null:t.hasError("required"))}}function xt(e,s){e&1&&(n(0,"div"),c(1," Categoria \xE9 obrigat\xF3ria "),r())}function bt(e,s){if(e&1&&(n(0,"div",21),d(1,xt,2,0,"div",22),r()),e&2){let t,o=m();a(),l("ngIf",(t=o.postForm.get("category"))==null?null:t.hasError("required"))}}var V=(()=>{class e{constructor(t,o){this.fb=t,this.blogService=o,this.isEditing=!1,this.artigoId=null,this.artigoSalvo=new y,this.isOpen=!1,this.isLoading=!1}ngOnInit(){this.createForm(),this.isEditing&&this.artigoId&&this.carregarDadosArtigo()}openModal(){this.isOpen=!0,this.isEditing&&this.artigoId&&this.carregarDadosArtigo()}createForm(){this.postForm=this.fb.group({title:["",S.required],content:["",S.required],author:["",S.required],category:["",S.required],imageUrl:[""]})}carregarDadosArtigo(){this.isLoading=!0,this.blogService.getArtigo(this.artigoId).subscribe({next:t=>{this.postForm.patchValue(t),this.isLoading=!1,this.isOpen=!0},error:t=>{this.isLoading=!1,console.error("Erro ao carregar artigo:",t)}})}onSubmit(){if(this.postForm.invalid)return;let t=this.postForm.value;this.isEditing&&this.artigoId?this.blogService.updateArtigo(this.artigoId,t).subscribe({next:()=>{this.artigoSalvo.emit(),this.closeModal()},error:o=>{console.error("Erro ao atualizar artigo:",o)}}):this.blogService.createArtigo(t).subscribe({next:()=>{this.artigoSalvo.emit(),this.closeModal()},error:o=>{console.error("Erro ao criar artigo:",o)}})}closeModal(){this.isOpen=!1,this.postForm.reset()}openWidget(){let t={cloudName:"dxokgmnnc",uploadPreset:"keystone_blog",folder:"images"};this.myWidget=cloudinary.createUploadWidget(t,(o,i)=>{o?console.error("Erro no upload:",o):i&&i.event==="success"?(console.log("Upload bem-sucedido:",i.info),this.postForm.patchValue({imageUrl:i.info.secure_url})):i&&console.log("Outro evento:",i.event)}),this.myWidget.open()}static{this.\u0275fac=function(o){return new(o||e)(v(nt),v(M))}}static{this.\u0275cmp=x({type:e,selectors:[["app-post-form"]],inputs:{isEditing:"isEditing",artigoId:"artigoId"},outputs:{artigoSalvo:"artigoSalvo"},standalone:!0,features:[C],decls:37,vars:9,consts:[["id","postModal",3,"closed","isOpen"],["id","postModal",1,"modal"],[1,"modal-content"],[1,"container","mt-3"],[1,"row","justify-content-center"],[1,"col-md-12"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","title"],["type","text","id","title","formControlName","title","required","",1,"form-control"],["class","text-danger",4,"ngIf"],["for","content"],["id","content","formControlName","content","rows","5","required","",1,"form-control"],["for","author"],["type","text","id","author","formControlName","author","required","",1,"form-control"],["for","category"],["type","text","id","category","formControlName","category","required","",1,"form-control"],["for","imageUrl"],["type","text","id","imageUrl","formControlName","imageUrl","readonly","",1,"form-control"],["type","button",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"text-danger"],[4,"ngIf"]],template:function(o,i){if(o&1&&(n(0,"app-modal",0),u("closed",function(){return i.closeModal()}),n(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h2"),c(7),r(),n(8,"form",6),u("ngSubmit",function(){return i.onSubmit()}),n(9,"div",7)(10,"label",8),c(11,"T\xEDtulo:"),r(),g(12,"input",9),d(13,ut,2,1,"div",10),r(),n(14,"div",7)(15,"label",11),c(16,"Conte\xFAdo:"),r(),g(17,"textarea",12),d(18,_t,2,1,"div",10),r(),n(19,"div",7)(20,"label",13),c(21,"Autor:"),r(),g(22,"input",14),d(23,vt,2,1,"div",10),r(),n(24,"div",7)(25,"label",15),c(26,"Categoria:"),r(),g(27,"input",16),d(28,bt,2,1,"div",10),r(),n(29,"div",7)(30,"label",17),c(31,"Imagem:"),r(),g(32,"input",18),r(),n(33,"button",19),u("click",function(){return i.openWidget()}),c(34," Upload Imagem "),r(),n(35,"button",20),c(36),r()()()()()()()()),o&2){let p,h,F,O;l("isOpen",i.isOpen),a(7),P(i.isEditing?"Editar Post":"Novo Post"),a(),l("formGroup",i.postForm),a(5),l("ngIf",((p=i.postForm.get("title"))==null?null:p.touched)&&((p=i.postForm.get("title"))==null?null:p.invalid)),a(5),l("ngIf",((h=i.postForm.get("content"))==null?null:h.touched)&&((h=i.postForm.get("content"))==null?null:h.invalid)),a(5),l("ngIf",((F=i.postForm.get("author"))==null?null:F.touched)&&((F=i.postForm.get("author"))==null?null:F.invalid)),a(5),l("ngIf",((O=i.postForm.get("category"))==null?null:O.touched)&&((O=i.postForm.get("category"))==null?null:O.invalid)),a(7),l("disabled",!i.postForm.valid),a(),I(" ",i.isEditing?"Salvar Altera\xE7\xF5es":"Criar Post"," ")}},dependencies:[at,B,tt,k,A,X,rt,ot,it,E],styles:[".modal-content[_ngcontent-%COMP%]{background:linear-gradient(to bottom right,var(--cor-primaria-transparente-leve),var(--cor-fundo-alternativa-transparente-leve));border:none;border-radius:8px;box-shadow:0 4px 10px #00000080;padding:30px 0}.close[_ngcontent-%COMP%]{color:var(--cor-texto-primaria);opacity:.8;transition:opacity .2s;position:relative;top:10px;right:15px}.close[_ngcontent-%COMP%]:hover, .close[_ngcontent-%COMP%]:focus{opacity:1}h2[_ngcontent-%COMP%]{color:var(--cor-texto-primaria);font-size:2rem;margin-bottom:40px;text-align:center}.form-group[_ngcontent-%COMP%]{position:relative;margin-bottom:2rem;display:flex;flex-direction:column;align-items:center}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{position:absolute;top:-20px;left:50%;transform:translate(-50%);background-color:transparent;color:var(--cor-texto-primaria);padding:0 5px;font-size:1rem;pointer-events:none;transition:all .2s ease-in-out}.form-control[_ngcontent-%COMP%]{width:70%;background-color:var(--cor-fundo);border:1px solid var(--cor-texto-secundaria);color:var(--cor-texto-primaria);border-radius:4px;padding:10px}.form-control[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 3px #293d714d}.form-control[_ngcontent-%COMP%]:focus + .form-label[_ngcontent-%COMP%], .form-control[_ngcontent-%COMP%]:not(:placeholder-shown) + .form-label[_ngcontent-%COMP%]{top:-10px;font-size:.7rem;color:var(--cor-primaria)}.btn-primary[_ngcontent-%COMP%], .btn-success[_ngcontent-%COMP%]{background-color:var(--cor-secundaria);border-color:var(--cor-secundaria);color:var(--cor-fundo);padding:10px 30px;font-weight:700;transition:background-color .3s;border-radius:4px;display:block;margin:0 auto}.btn-primary[_ngcontent-%COMP%]:hover, .btn-success[_ngcontent-%COMP%]:hover{background-color:#c89f2f;border-color:#c89f2f;color:var(--cor-texto-primaria);cursor:pointer}a[_ngcontent-%COMP%]{color:var(--cor-destaque-1);text-decoration:none}a[_ngcontent-%COMP%]:hover{text-decoration:underline}.text-danger[_ngcontent-%COMP%]{color:var(--cor-destaque-2);font-size:.8rem;margin-top:5px}"]})}}return e})();var ht=e=>["/artigos",e];function Et(e,s){if(e&1&&g(0,"img",10),e&2){let t=m(2);j("alt",t.artigo.title),l("src",t.artigo.imageUrl,L)}}function Mt(e,s){if(e&1){let t=b();n(0,"button",11),u("click",function(){_(t);let i=m(2);return f(i.editarArtigo(i.artigo))}),c(1," Editar "),r()}}function yt(e,s){if(e&1){let t=b();n(0,"button",11),u("click",function(){_(t);let i=m(2);return f(i.excluirArtigo(i.artigo))}),c(1," Excluir "),r()}}function Pt(e,s){if(e&1&&(n(0,"div",1),d(1,Et,1,2,"img",2),n(2,"div",3)(3,"h5",4),c(4),r(),n(5,"p",5),c(6),r(),n(7,"p",5)(8,"small",6),c(9),Q(10,"date"),r()(),n(11,"a",7),c(12,"Ler mais"),r(),n(13,"div",8),d(14,Mt,2,0,"button",9)(15,yt,2,0,"button",9),r()()()),e&2){let t=m();a(),l("ngIf",t.artigo.imageUrl),a(3),P(t.artigo.title),a(2),P(t.truncateContent(t.artigo.content)),a(3),I("Publicado em: ",$(10,7,t.artigo.createdAt),""),a(2),l("routerLink",G(9,ht,t.artigo._id)),a(3),l("ngIf",t.authService.getRole()==="admin"),a(),l("ngIf",t.authService.getRole()==="admin")}}var st=(()=>{class e{constructor(t,o){this.blogService=t,this.authService=o,this.artigoEditado=new y,this.artigoExcluido=new y,this.artigos=[],this.isLoading=!0}editarArtigo(t){let o=this.modalContainer.createComponent(V);o.instance.artigoId=t._id,o.instance.isEditing=!0,o.instance.artigoSalvo.subscribe(()=>{this.artigoEditado.emit(),this.modalContainer.clear()}),o.instance.openModal()}excluirArtigo(t){confirm(`Tem certeza de que deseja excluir o artigo "${t.title}"?`)&&this.blogService.deleteArtigo(t._id).subscribe({next:()=>{this.artigoExcluido.emit()},error:o=>{console.error("Erro ao excluir artigo:",o)}})}truncateContent(t,o=100){return t.length>o?t.substring(0,o)+"...":t}static{this.\u0275fac=function(o){return new(o||e)(v(M),v(T))}}static{this.\u0275cmp=x({type:e,selectors:[["app-artigo-card"]],inputs:{artigo:"artigo",modalContainer:"modalContainer"},outputs:{artigoEditado:"artigoEditado",artigoExcluido:"artigoExcluido"},standalone:!0,features:[C],decls:1,vars:1,consts:[["class","card",4,"ngIf"],[1,"card"],["class","card-img-top",3,"src","alt",4,"ngIf"],[1,"card-body"],[1,"card-title"],[1,"card-text"],[1,"text-muted"],[1,"btn","btn-primary",3,"routerLink"],[1,"artigo-control"],[3,"click",4,"ngIf"],[1,"card-img-top",3,"src","alt"],[3,"click"]],template:function(o,i){o&1&&d(0,Pt,16,11,"div",0),o&2&&l("ngIf",i.artigo)},dependencies:[E,J,K],styles:[".card[_ngcontent-%COMP%]{display:flex;background:linear-gradient(to bottom,var(--cor-primaria-transparente),var(--cor-fundo-alternativa-transparente));border:none;max-width:60%;margin-bottom:2rem;border-radius:8px;overflow:hidden;box-shadow:0 4px 8px #0003;transition:transform .3s ease,box-shadow .3s ease}.card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 6px 12px #0000004d}.card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{padding-top:1.5rem;padding-left:1rem;margin-bottom:2rem;height:180px;object-fit:cover}.card-body[_ngcontent-%COMP%]{padding:0 1.5rem 1.5rem}.card-title[_ngcontent-%COMP%]{font-size:1.2rem;color:var(--cor-texto-primaria);margin-top:1.2rem;margin-bottom:.5rem}.card-text[_ngcontent-%COMP%]{color:var(--cor-texto-secundaria);margin-bottom:1rem}.btn-primary[_ngcontent-%COMP%]{padding:.4rem;border-radius:4px;text-decoration:none;color:var(--cor-texto-primaria);background-color:var(--cor-secundaria);border-color:var(--cor-destaque-1);transition:background-color .3s ease,border-color .3s ease}.btn-primary[_ngcontent-%COMP%]:hover{background-color:var(--cor-primaria);border-color:var(--cor-primaria)}.artigo-control[_ngcontent-%COMP%]{display:flex;max-width:6.8rem;justify-content:space-between;padding-top:1rem}@media (max-width: 768px){.card[_ngcontent-%COMP%]{max-width:100%;margin:1rem 0}.card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{padding:1rem;object-fit:contain}.artigo-control[_ngcontent-%COMP%]{justify-content:flex-start}}"]})}}return e})();var St=["modal"];function Ft(e,s){e&1&&(n(0,"div")(1,"p"),c(2,"Carregando artigos..."),r()())}function Ot(e,s){if(e&1){let t=b();n(0,"button",8),u("click",function(){_(t);let i=m();return f(i.abrirModalNovoPost())}),c(1," Criar Artigo "),r()}}function wt(e,s){if(e&1){let t=b();n(0,"div")(1,"app-artigo-card",10),u("artigoEditado",function(){_(t);let i=m(2);return f(i.reloadArtigos())})("artigoExcluido",function(){_(t);let i=m(2);return f(i.reloadArtigos())}),r()()}if(e&2){let t=s.$implicit,o=m(2);a(),l("artigo",t)("modalContainer",o.modalContainer)}}function It(e,s){if(e&1&&(n(0,"div"),d(1,wt,2,2,"div",9),r()),e&2){let t=m();a(),l("ngForOf",t.artigosFiltrados())}}function kt(e,s){if(e&1){let t=b();n(0,"button",8),u("click",function(){_(t);let i=m(2);return f(i.abrirModalNovoPost())}),c(1," Criar Artigo "),r()}}function At(e,s){if(e&1&&(n(0,"div")(1,"p"),c(2,"Ainda n\xE3o h\xE1 nenhum artigo. Clique aqui para criar o primeiro:"),r(),d(3,kt,2,0,"button",7),r()),e&2){let t=m();a(3),l("ngIf",t.authService.getRole()==="admin")}}function Bt(e,s){}var dt=(()=>{class e{constructor(t,o){this.blogService=t,this.authService=o,this.artigos=[],this.isLoading=!0,this.showModal=!1,this.filtroBusca=new Z(""),this.criterioBusca="titulo"}ngOnInit(){this.reloadArtigos()}abrirModalNovoPost(){let t=this.modalContainer.createComponent(V);t.instance.isEditing=!1,t.instance.artigoSalvo.subscribe(()=>{this.reloadArtigos()}),t.instance.openModal()}reloadArtigos(){this.isLoading=!0,this.blogService.getArtigos().pipe(D(t=>this.artigos=t),N(()=>this.isLoading=!1)).subscribe({error:t=>{console.error("Erro ao buscar artigos:",t)},complete:()=>{console.log("Recarregamento de artigos completo.")}})}alterarCriterio(t){this.criterioBusca=t,this.filtroBusca.reset()}artigosFiltrados(){let t=this.filtroBusca.value?.toLowerCase().trim();return t?this.artigos.filter(o=>{switch(this.criterioBusca){case"titulo":return o.title.toLowerCase().includes(t);case"autor":return o.author.toLowerCase().includes(t);case"categoria":return o.category.toLowerCase().includes(t);default:return!0}}):this.artigos}static{this.\u0275fac=function(o){return new(o||e)(v(M),v(T))}}static{this.\u0275cmp=x({type:e,selectors:[["app-blog-main"]],viewQuery:function(o,i){if(o&1&&U(St,7,R),o&2){let p;z(p=W())&&(i.modalContainer=p.first)}},standalone:!0,features:[C],decls:16,vars:11,consts:[["modal",""],[1,"blog-main"],[1,"search-container"],["type","text","placeholder","Buscar artigos...",1,"search-input",3,"formControl"],[1,"filter-buttons"],[1,"filter-button",3,"click"],[4,"ngIf"],[3,"click",4,"ngIf"],[3,"click"],[4,"ngFor","ngForOf"],[3,"artigoEditado","artigoExcluido","artigo","modalContainer"]],template:function(o,i){if(o&1){let p=b();n(0,"section",1)(1,"div",2),g(2,"input",3),n(3,"div",4)(4,"button",5),u("click",function(){return _(p),f(i.alterarCriterio("titulo"))}),c(5," T\xEDtulo "),r(),n(6,"button",5),u("click",function(){return _(p),f(i.alterarCriterio("autor"))}),c(7," Autor "),r(),n(8,"button",5),u("click",function(){return _(p),f(i.alterarCriterio("categoria"))}),c(9," Categoria "),r()()(),d(10,Ft,3,0,"div",6)(11,Ot,2,0,"button",7)(12,It,2,1,"div",6)(13,At,4,1,"div",6),r(),d(14,Bt,0,0,"ng-template",null,0,Y)}o&2&&(a(2),l("formControl",i.filtroBusca),a(2),w("active",i.criterioBusca==="titulo"),a(2),w("active",i.criterioBusca==="autor"),a(2),w("active",i.criterioBusca==="categoria"),a(2),l("ngIf",i.isLoading),a(),l("ngIf",i.authService.getRole()==="admin"),a(),l("ngIf",!i.isLoading&&i.artigosFiltrados().length>0),a(),l("ngIf",!i.isLoading&&i.artigosFiltrados().length===0))},dependencies:[st,H,E,B,k,A,et],styles:[".search-container[_ngcontent-%COMP%]{top:20px;right:20px;margin-top:.3rem;margin-bottom:1rem;display:flex;align-items:center}.search-input[_ngcontent-%COMP%]{margin-right:10px}.filter-buttons[_ngcontent-%COMP%]{display:flex}.filter-button[_ngcontent-%COMP%]{margin-left:5px;padding:5px 10px;border:1px solid var(--cor-texto-secundaria);background-color:transparent;color:var(--cor-texto-secundaria);cursor:pointer;transition:background-color .3s ease,color .3s ease,border-color .3s ease;border-radius:5px}.filter-button.active[_ngcontent-%COMP%]{background-color:var(--cor-destaque-1);color:var(--cor-texto-primaria);border-color:var(--cor-destaque-1)}input[type=text][_ngcontent-%COMP%]{padding:8px;border:1px solid var(--cor-texto-secundaria);border-radius:5px;background-color:var(--cor-fundo-alternativa);color:var(--cor-texto-primaria);transition:border-color .3s ease,box-shadow .3s ease}input[type=text][_ngcontent-%COMP%]:focus{outline:none;border-color:var(--cor-destaque-1);box-shadow:0 0 5px var(--cor-destaque-1)}.blog-main[_ngcontent-%COMP%]{background-image:url(https://res.cloudinary.com/dxokgmnnc/image/upload/v1734039309/blog_qp6eql.jpg);background-size:cover;background-repeat:no-repeat;color:var(--cor-texto-primaria);padding:2rem}.blog-main[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:var(--cor-secundaria);text-align:center;margin-bottom:2rem}.blog-main[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{line-height:1.6;margin-bottom:1rem}button[_ngcontent-%COMP%]{background-color:var(--cor-primaria);color:var(--cor-texto-primaria);border:none;padding:5px 10px;border-radius:5px;cursor:pointer;transition:background-color .3s ease}button[_ngcontent-%COMP%]:hover{background-color:var(--cor-fundo)}"]})}}return e})();var ne=(()=>{class e{static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275cmp=x({type:e,selectors:[["app-blog"]],standalone:!0,features:[C],decls:2,vars:0,template:function(o,i){o&1&&g(0,"app-blog-banner")(1,"app-blog-main")},dependencies:[dt,lt],encapsulation:2})}}return e})();export{ne as BlogComponent};
